{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47406672-32912a9d4734ffdd3d590f70b';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\n/**\n * Fetches images from Pixabay API.\n * @param {string} query - The search query.\n * @param {number} page - The page number for pagination.\n * @returns {Promise<object>} The response data from the API.\n */\nexport const fetchImages = async (query, page = 1) => {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: PER_PAGE,\n  };\n\n  try {\n    const { data } = await axios.get(BASE_URL, { params });\n    if (data.totalHits === 0) {\n      throw new Error('No images found for your query.');\n    }\n    return data;\n  } catch (error) {\n    throw new Error(error.response?.data?.message || 'Failed to fetch images.');\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n/**\n * Renders a gallery markup.\n * @param {Array} images - The list of image objects.\n * @returns {string} - The generated HTML markup.\n */\nexport const renderGallery = (images) => {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <div class=\"photo-card\">\n      <a href=\"${largeImageURL}\" class=\"gallery__item\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery__image\" />\n      </a>\n      <div class=\"info\">\n        <p><b>Likes:</b> ${likes}</p>\n        <p><b>Views:</b> ${views}</p>\n        <p><b>Comments:</b> ${comments}</p>\n        <p><b>Downloads:</b> ${downloads}</p>\n      </div>\n    </div>`\n    )\n    .join('');\n};\n\n/**\n * Initializes the lightbox for the gallery.\n * @returns {SimpleLightbox} The initialized SimpleLightbox instance.\n */\nexport const initializeLightbox = () => {\n  return new SimpleLightbox('.gallery__item', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n};\n\n/**\n * Scrolls the page smoothly by the height of two gallery cards.\n */\nexport const smoothScroll = () => {\n  const cardHeight = document.querySelector('.photo-card')?.getBoundingClientRect().height || 0;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n","import { fetchImages } from './js/pixabay-api';\nimport { renderGallery, initializeLightbox, smoothScroll } from './js/render-functions';\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet lightbox;\n\nlet searchQuery = '';\nlet currentPage = 1;\n\n// Скрыть кнопку \"Load more\" изначально\nloadMoreBtn.style.display = 'none';\n\n/**\n * Обработка события отправки формы\n * @param {Event} event\n */\nconst onSearchSubmit = async (event) => {\n  event.preventDefault();\n\n  searchQuery = event.currentTarget.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    alert('Please enter a search query.');\n    return;\n  }\n\n  // Очистка галереи и сброс страницы\n  gallery.innerHTML = '';\n  currentPage = 1;\n  loadMoreBtn.style.display = 'none';\n\n  try {\n    const data = await fetchImages(searchQuery, currentPage);\n    renderImages(data.hits);\n    handleLoadMoreVisibility(data.totalHits);\n  } catch (error) {\n    alert(error.message);\n  }\n};\n\n/**\n * Загрузка дополнительных изображений\n */\nconst onLoadMore = async () => {\n  currentPage += 1;\n\n  try {\n    const data = await fetchImages(searchQuery, currentPage);\n    renderImages(data.hits);\n    handleLoadMoreVisibility(data.totalHits);\n    smoothScroll();\n  } catch (error) {\n    alert(error.message);\n  }\n};\n\n/**\n * Отображение изображений в галерее\n * @param {Array} images\n */\nconst renderImages = (images) => {\n  const markup = renderGallery(images);\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (!lightbox) {\n    lightbox = initializeLightbox();\n  } else {\n    lightbox.refresh();\n  }\n};\n\n/**\n * Управляет видимостью кнопки Load More\n * @param {number} totalHits\n */\nconst handleLoadMoreVisibility = (totalHits) => {\n  const totalLoaded = currentPage * 15; // 15 - количество на страницу\n  if (totalLoaded >= totalHits) {\n    loadMoreBtn.style.display = 'none';\n    alert(\"We're sorry, but you've reached the end of search results.\");\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n};\n\n// Обработчики событий\nsearchForm.addEventListener('submit', onSearchSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","query","page","params","data","axios","error","_b","_a","renderGallery","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","initializeLightbox","SimpleLightbox","smoothScroll","cardHeight","searchForm","gallery","loadMoreBtn","lightbox","searchQuery","currentPage","onSearchSubmit","event","renderImages","handleLoadMoreVisibility","onLoadMore","markup","totalHits"],"mappings":"6vBAEA,MAAMA,EAAU,qCACVC,EAAW,2BACXC,EAAW,GAQJC,EAAc,MAAOC,EAAOC,EAAO,IAAM,SACpD,MAAMC,EAAS,CACb,IAAKN,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUH,CACd,EAEE,GAAI,CACF,KAAM,CAAE,KAAAK,CAAM,EAAG,MAAMC,EAAM,IAAIP,EAAU,CAAE,OAAAK,CAAM,CAAE,EACrD,GAAIC,EAAK,YAAc,EACrB,MAAM,IAAI,MAAM,iCAAiC,EAEnD,OAAOA,CACR,OAAQE,EAAO,CACd,MAAM,IAAI,QAAMC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,UAAW,yBAAyB,CAC3E,CACH,ECxBaE,EAAiBC,GACrBA,EACJ,IACC,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,iBAEnEL,CAAa;AAAA,oBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,2BAGnBC,CAAK;AAAA,2BACLC,CAAK;AAAA,8BACFC,CAAQ;AAAA,+BACPC,CAAS;AAAA;AAAA,WAGnC,EACA,KAAK,EAAE,EAOCC,EAAqB,IACzB,IAAIC,EAAe,iBAAkB,CAC1C,aAAc,MACd,aAAc,GAClB,CAAG,EAMUC,EAAe,IAAM,OAChC,MAAMC,IAAab,EAAA,SAAS,cAAc,aAAa,IAApC,YAAAA,EAAuC,wBAAwB,SAAU,EAC5F,OAAO,SAAS,CACd,IAAKa,EAAa,EAClB,SAAU,QACd,CAAG,CACH,EC5CMC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,YAAY,EACvD,IAAIC,EAEAC,EAAc,GACdC,EAAc,EAGlBH,EAAY,MAAM,QAAU,OAM5B,MAAMI,EAAiB,MAAOC,GAAU,CAItC,GAHAA,EAAM,eAAc,EAEpBH,EAAcG,EAAM,cAAc,SAAS,YAAY,MAAM,OACzD,CAACH,EAAa,CAChB,MAAM,8BAA8B,EACpC,MACD,CAGDH,EAAQ,UAAY,GACpBI,EAAc,EACdH,EAAY,MAAM,QAAU,OAE5B,GAAI,CACF,MAAMpB,EAAO,MAAMJ,EAAY0B,EAAaC,CAAW,EACvDG,EAAa1B,EAAK,IAAI,EACtB2B,EAAyB3B,EAAK,SAAS,CACxC,OAAQE,EAAO,CACd,MAAMA,EAAM,OAAO,CACpB,CACH,EAKM0B,EAAa,SAAY,CAC7BL,GAAe,EAEf,GAAI,CACF,MAAMvB,EAAO,MAAMJ,EAAY0B,EAAaC,CAAW,EACvDG,EAAa1B,EAAK,IAAI,EACtB2B,EAAyB3B,EAAK,SAAS,EACvCgB,GACD,OAAQd,EAAO,CACd,MAAMA,EAAM,OAAO,CACpB,CACH,EAMMwB,EAAgBpB,GAAW,CAC/B,MAAMuB,EAASxB,EAAcC,CAAM,EACnCa,EAAQ,mBAAmB,YAAaU,CAAM,EAEzCR,EAGHA,EAAS,QAAO,EAFhBA,EAAWP,EAAkB,CAIjC,EAMMa,EAA4BG,GAAc,CAC1BP,EAAc,IACfO,GACjBV,EAAY,MAAM,QAAU,OAC5B,MAAM,4DAA4D,GAElEA,EAAY,MAAM,QAAU,OAEhC,EAGAF,EAAW,iBAAiB,SAAUM,CAAc,EACpDJ,EAAY,iBAAiB,QAASQ,CAAU"}